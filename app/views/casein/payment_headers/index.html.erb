<!-- Scaffolding generated by Casein v5.1.1.5 -->

<% if @form.errors.present? -%>
  <div class="alert alert-danger" role="alert">
    定例データ一括作成に失敗しました
    <ul>
    <% @form.errors.full_messages.each do |msg| %>
      <li><%= msg %></li>
    <% end %>
    </ul>
  </div>
<% end -%>

<h2>支払申請書<%= casein_pagination_details @payment_headers %></h2>
<%= form_for @form, as: :q, url: casein_payment_headers_path, method: :get do |f| %>
  <div class="row">
    <div class="col-lg-2">
      伝票No
      <%= f.text_field :slip_no, size: 10 %>
    </div>
    <div class="col-lg-3">
      取引先名
      <%= f.text_field :account_name  %>
    </div>
    <div class="col-lg-3">
      日付
      <%= f.text_field :from, placeholder: 'yyyy/mm/dd', "data-provide" => "datepicker", size: 12 %>
      〜
      <%= f.text_field :to, placeholder: 'yyyy/mm/dd', "data-provide" => "datepicker", size: 12 %>
    </div>
    <div class="col-lg-3">
      <label>
        <%= f.check_box :planned_true %>&nbsp;予定
      </label>
      &nbsp;
      <label>
        <%= f.check_box :planned_false %>&nbsp;実績
      </label>
      &nbsp;
      <label>
        <%= f.check_box :monthly_data_true %>&nbsp;定例
      </label>
    </div>
    <div class="col-lg-1">
      <%= f.submit "検索", :name => nil %>
    </div>
  </div>
<% end %>

<div class="row" style="margin-top: 20px;">
  <div class="col-lg-3">
    <% if @sum_amount -%>
      <div class="well" style="margin-bottom: 0px;">
        金額: <%= number_with_delimiter @sum_amount %> 円
      </div>
    <% end -%>
  </div>
  <div class="col-lg-offset-7 col-lg-2">
    <div class="pull-right">
      <%= form_for @form, as: :q, url: duplicate_monthly_data_casein_payment_headers_path, method: :post do |f| %>
        <% f.object.attributes.each do |key, value| -%>
          <%= f.hidden_field key %>
        <% end -%>

        <%= f.submit "定例データ一括作成", name: nil, class: 'btn btn-primary', disabled: @payment_headers.empty? || !@form.valid?(:duplicate_monthly_data), disable_with: "作成中", data: {confirm: "検索結果の定例データから次月のデータを作成します。よろしいですか？"} %>
      <% end %>
    </div>
  </div>
</div>

<%= render :partial => 'casein/payment_headers/table', :locals => { :payment_headers => @payment_headers } %>

<div class="text-center">
  <%= will_paginate @payment_headers %>
</div>
